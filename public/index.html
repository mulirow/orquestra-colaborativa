<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orquestra Colaborativa</title>

    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="home-container">
        <!-- Tela Home / Seleção de Sala -->
        <div id="roomModal" class="modal hidden">
            <div class="modal-content">
                <h2>Bem-vindo à Orquestra Colaborativa</h2>
                <p>Escolha uma sala para começar a criar música com outros!</p>

                <h3>Salas Disponíveis:</h3>
                <div id="roomList" class="room-list"></div>

                <div class="create-room-section">
                    <h3 class="small">Criar Nova Sala:</h3>
                    <div class="create-room-input-container">
                        <input type="text" id="newRoomInput" placeholder="Nome da sua sala...">
                        <button id="createRoomBtn" class="btn-play">Criar Sala</button>
                    </div>
                </div>
                
                <div id="closeRoomModalSection" class="close-modal-section hidden">
                    <button id="closeRoomModalBtn" class="btn-play">Continuar na Sala Atual</button>
                </div>
            </div>
        </div>

        <div class="title-container">
            <h1>Orquestra Colaborativa</h1>
            <div class="room-info-container">
                <button id="viewRoomsBtn" class="btn-view-rooms">Ver Salas</button>
                <button id="qrCodeBtn" class="qr-btn hidden">Convide seus amigos</button>
                <div class="user-info-container">
                    <div id="currentRoomName">Sala: -</div>
                    <div id="userCount">0 online</div>
                    <div id="statusText">AGUARDANDO INÍCIO...</div>
                </div>
            </div>
        </div>
        

        <!-- Modal de Sala Existente -->
        <div id="roomExistsModal" class="modal hidden">
            <div class="modal-content">
                <h2>Sala Já Existe</h2>
                <p class="room-exists-message">A sala "<span id="existingRoomName"></span>" já existe com <span id="existingRoomUsers"></span> usuário(s) online.</p>
                <div class="modal-buttons">
                    <button id="joinExistingRoomBtn" class="btn-play">Entrar na Sala</button>
                    <button id="cancelRoomExistsBtn">Cancelar</button>
                </div>
            </div>
        </div>

        <!-- Modal de QR Code -->
        <div id="qrModal" class="modal hidden">
            <div class="modal-content">
                <h2>Compartilhe esta Sala</h2>
                <p class="qr-modal-description">Escaneie o QR Code para entrar</p>
                <div id="qrCodeContainer"></div>
                <div class="qr-url-section">
                    <input type="text" id="roomUrlInput" readonly>
                    <button id="copyUrlBtn" class="btn-play full-width">Copiar Link</button>
                </div>
                <button id="closeQrBtn">Fechar</button>
            </div>
        </div>

        <div id="sequencer-container"></div>

        <div id="controls" class="full-width">
            <!-- Play / Pause -->
            <div class="control-section">
                <button id="audioToggleBtn" class="btn-play">INICIAR ÁUDIO</button>
                <div class="bpm-display">BPM: 120</div>
            </div>

            <!-- Time Machine -->
            <div class="control-section">
                <div class="control-section-content">
                    <div class="control-section-header">
                        <span class="control-section-title">Time Machine</span>
                        <span id="replayCounter">Histórico: 0 estados</span>
                    </div>

                    <div class="control-section-buttons">
                        <button id="linearReplayBtn" disabled>Histórico Visual</button>

                        <div class="slider-container">
                            <span>Lento</span>
                            <input type="range" id="speedRange" min="1" max="20" value="10">
                            <span>Rápido</span>
                        </div>
                    </div>

                    <div class="control-section-buttons margin-top">
                        <button id="cyclicReplayBtn" disabled>Timelapse</button>
                    </div>

                    <div id="replayBar">
                        <div id="replayProgress"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="script.js"></script>

</body>

</html>